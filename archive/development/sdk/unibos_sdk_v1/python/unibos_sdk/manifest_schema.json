{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://unibos.org/schemas/module-manifest.json",
  "title": "UNIBOS Module Manifest",
  "description": "Schema for UNIBOS module.json manifest files",
  "type": "object",
  "required": ["id", "name", "version", "description", "icon"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z_]+$",
      "description": "Unique module identifier (snake_case, lowercase only)",
      "examples": ["birlikteyiz", "currencies", "wimm"]
    },
    "name": {
      "type": "string",
      "minLength": 1,
      "description": "Human-readable module name",
      "examples": ["Birlikteyiz", "Currencies", "Where Is My Money"]
    },
    "display_name": {
      "type": "object",
      "description": "Localized display names",
      "properties": {
        "tr": { "type": "string" },
        "en": { "type": "string" },
        "es": { "type": "string" },
        "fr": { "type": "string" },
        "de": { "type": "string" }
      },
      "additionalProperties": { "type": "string" }
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version (MAJOR.MINOR.PATCH)",
      "examples": ["1.0.0", "2.1.3"]
    },
    "description": {
      "type": "string",
      "minLength": 10,
      "maxLength": 200,
      "description": "Short description of module functionality"
    },
    "icon": {
      "type": "string",
      "minLength": 1,
      "maxLength": 10,
      "description": "Emoji icon for UI representation",
      "examples": ["ðŸ“¡", "ðŸ’°", "ðŸ“„"]
    },
    "author": {
      "type": "string",
      "description": "Module author name"
    },
    "capabilities": {
      "type": "object",
      "description": "Module capabilities",
      "properties": {
        "backend": {
          "type": "boolean",
          "description": "Has Django backend app",
          "default": true
        },
        "web": {
          "type": "boolean",
          "description": "Has standalone web application",
          "default": false
        },
        "mobile": {
          "type": "boolean",
          "description": "Has mobile application",
          "default": false
        },
        "cli": {
          "type": "boolean",
          "description": "Has CLI interface",
          "default": false
        },
        "realtime": {
          "type": "boolean",
          "description": "Uses WebSocket/real-time features",
          "default": false
        }
      },
      "additionalProperties": false
    },
    "dependencies": {
      "type": "object",
      "description": "Module dependencies",
      "properties": {
        "core_modules": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["authentication", "users", "permissions", "shared_models"]
          },
          "description": "Required core modules"
        },
        "other_modules": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Required other modules"
        },
        "python_packages": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Required Python packages"
        },
        "system_requirements": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["redis", "postgresql", "celery", "channels"]
          },
          "description": "Required system components"
        }
      },
      "additionalProperties": false
    },
    "database": {
      "type": "object",
      "description": "Database configuration",
      "properties": {
        "uses_shared_db": {
          "type": "boolean",
          "description": "Uses shared UNIBOS database",
          "default": true
        },
        "tables_prefix": {
          "type": "string",
          "pattern": "^[a-z_]+_$",
          "description": "Table name prefix (must end with underscore)",
          "examples": ["birlikteyiz_", "currencies_"]
        },
        "models": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of model names"
        }
      },
      "additionalProperties": false
    },
    "api": {
      "type": "object",
      "description": "API configuration",
      "properties": {
        "base_path": {
          "type": "string",
          "pattern": "^/api/v\\d+/[a-z_]+/$",
          "description": "API base path",
          "examples": ["/api/v1/birlikteyiz/", "/api/v1/currencies/"]
        },
        "endpoints": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["path", "methods"],
            "properties": {
              "path": {
                "type": "string",
                "description": "Endpoint path"
              },
              "methods": {
                "type": "array",
                "items": {
                  "type": "string",
                  "enum": ["GET", "POST", "PUT", "PATCH", "DELETE"]
                }
              },
              "public": {
                "type": "boolean",
                "description": "Public endpoint (no auth required)",
                "default": false
              },
              "auth_required": {
                "type": "boolean",
                "description": "Authentication required",
                "default": true
              }
            }
          },
          "description": "API endpoints"
        }
      },
      "additionalProperties": false
    },
    "permissions": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^[a-z_]+\\.[a-z_]+$"
      },
      "description": "Required permissions",
      "examples": [
        ["birlikteyiz.view_earthquake", "birlikteyiz.create_safe_zone"]
      ]
    },
    "celery_tasks": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Celery task names"
    },
    "channels": {
      "type": "object",
      "description": "WebSocket/Channels configuration",
      "properties": {
        "websocket_routes": {
          "type": "array",
          "items": { "type": "string" },
          "description": "WebSocket route paths"
        }
      },
      "additionalProperties": false
    },
    "integration": {
      "type": "object",
      "description": "UNIBOS integration settings",
      "properties": {
        "sidebar": {
          "type": "object",
          "description": "Sidebar integration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Show in sidebar",
              "default": true
            },
            "position": {
              "type": "integer",
              "minimum": 1,
              "description": "Position in sidebar (lower = higher)"
            },
            "category": {
              "type": "string",
              "enum": ["general", "finance", "content", "security", "tools"],
              "description": "Sidebar category"
            }
          },
          "additionalProperties": false
        },
        "dashboard_widgets": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "title"],
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" },
              "size": {
                "type": "string",
                "enum": ["small", "medium", "large"],
                "default": "medium"
              }
            }
          },
          "description": "Dashboard widgets"
        }
      },
      "additionalProperties": false
    },
    "mobile_app": {
      "type": "object",
      "description": "Mobile app configuration",
      "properties": {
        "package": {
          "type": "string",
          "description": "App package name",
          "examples": ["org.unibos.birlikteyiz"]
        },
        "min_version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Minimum app version"
        },
        "store_urls": {
          "type": "object",
          "properties": {
            "ios": { "type": "string", "format": "uri" },
            "android": { "type": "string", "format": "uri" }
          }
        }
      },
      "additionalProperties": false
    },
    "development": {
      "type": "object",
      "description": "Development information",
      "properties": {
        "repository": {
          "type": "string",
          "format": "uri",
          "description": "Git repository URL"
        },
        "documentation": {
          "type": "string",
          "format": "uri",
          "description": "Documentation URL"
        },
        "maintainer": {
          "type": "string",
          "format": "email",
          "description": "Maintainer email"
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
